================================================================================
FEDERATED LEARNING EXPERIMENT - FULL RUN
================================================================================
Output Directory: fl_experiment_20260116_153133
Num Clients: 5
Num Rounds: 15
================================================================================

Using device: cpu
Random seed: 42

================================================================================
STEP 1: Loading Data
================================================================================

================================================================================
STEP 2: Creating Splits (Scaler fit on train only)
================================================================================

================================================================================
STEP 3: Dirichlet Partitioning (Non-IID)
================================================================================
[SAVED] fl_experiment_20260116_153133/01_client_heterogeneity.png

================================================================================
STEP 3.5: Hyperparameter Tuning
================================================================================
Models to tune: all
Trials per model: 10

[COMPLETE] Hyperparameter tuning results saved to fl_experiment_20260116_153133/

[LOADING] Tuned hyperparameters from fl_experiment_20260116_153133\best_hyperparams.json
  MLP: {'lr': 0.006847920095574782, 'hidden1': 64, 'hidden2': 48, 'dropout': 0.18318092164684585}
  LSTM: {'lr': 0.00621870472776908, 'hidden': 32, 'layers': 4, 'dropout': 0.41436875457596467}
  XGBOOST: {}
  LogisticRegression: {'C': 0.0019517224641449498, 'solver': 'lbfgs'}

================================================================================
STEP 4: Federated Learning (MLP)
================================================================================
[SAVED] fl_experiment_20260116_153133/mlp_model.pth
[SAVED] fl_experiment_20260116_153133/mlp_config.json

================================================================================
STEP 5: Calibration Methods Comparison
================================================================================
[SAVED] Calibration models: platt_scaler.pth, temperature_scaler.pth, beta_scaler.pth

================================================================================
STEP 6: Federated Learning (LSTM)
================================================================================
[SAVED] fl_experiment_20260116_153133/lstm_model.pth
[SAVED] fl_experiment_20260116_153133/lstm_config.json

================================================================================
STEP 7: Training Baseline Models
================================================================================
[SAVED] fl_experiment_20260116_153133/central_nn.pth

================================================================================
STEP 7b: Comprehensive Calibration Analysis
================================================================================

Calibration Analysis Summary (Best ECE per model):
  FL-FedAvg (MLP): Beta (ECE=0.0619)
  FL-FedAvg (LSTM): Beta (ECE=0.0601)
  Central NN: Uncalibrated (ECE=0.0398)

================================================================================
STEP 8: Final Model Comparison
================================================================================

FINAL MODEL LEADERBOARD:
              Model  Accuracy       F1      ECE
Logistic Regression  0.675333 0.457079 0.235706
         Central NN  0.814444 0.398198 0.039822
             FL-MLP  0.807222 0.318271 0.061868
     Local NN (Avg)  0.566633 0.280006 0.358500
            FL-LSTM  0.778889 0.000000 0.060100

================================================================================
STEP 9: SHAP Analysis
================================================================================
[SAVED] fl_experiment_20260116_153133/07_shap_summary.png

================================================================================
STEP 9b: LIME Analysis
================================================================================

================================================================================
EXPERIMENT COMPLETE
================================================================================

Results saved to: fl_experiment_20260116_153133/
  - experiment_log.txt
  - results_summary.csv
  - Visualization figures

================================================================================
KEY FINDINGS
================================================================================
  - Results Summary and Leaderboard above

================================================================================
